@page "/"
@using Microsoft.AspNetCore.Components.QuickGrid;
@using NeoSmart.PrettySize;
@using ClientPages.Shared;
@using ClientFileApi;
@inject ClientFileApi.ClientFileAccess ClientFiles;

<MudAppBar Class="gap-2">   
    <MudText Typo="Typo.h5">The Player</MudText>
    @if (files is not null)
    {
        
    }
    <MudSpacer />    
    <MudFab OnClick="OpenDir" Color="Color.Warning" StartIcon="@Icons.Material.Filled.Add" Size="Size.Small" />    
</MudAppBar>

@if (files is not null)
{
    <MudDataGrid Items="@files" SortMode="SortMode.Multiple" QuickFilter="@quickFilter">
        <ToolBarContent>
            <MudText Typo="Typo.h6" Class="mr-4">Audio List</MudText>
            <MudText Typo="Typo.body1">@files.Count() songs</MudText>
            <MudSpacer />
            <MudTextField @bind-Value="searchString" 
                          Placeholder="Search" 
                          Adornment="Adornment.Start" 
                          Immediate="true"
                          AdornmentIcon="@Icons.Material.Filled.Search" 
                          IconSize="Size.Medium" Class="mt-0" />            
        </ToolBarContent>
        <Columns>
            <Column T="ClientFileAccess.ClientFile" Title="Name" Field="Name" Sortable="true" />
            <Column T="ClientFileAccess.ClientFile" Title="Size" Field="Size" Sortable="true" />
            <Column T="ClientFileAccess.ClientFile" Title="Relative Path" Field="RelativePath" Sortable="true" />
            <Column T="ClientFileAccess.ClientFile" Title="Audio">
                <CellTemplate>                                        
                    <Audio File="@context.Item"></Audio>
                    @*<EAudio AudioFilePath="@context.Item.Path"></EAudio>*@
                </CellTemplate>
            </Column>          
        </Columns> 
    </MudDataGrid>    

}
else
{

    <MudText Typo="Typo.h6" Align="MudBlazor.Align.Center">Let's start the party!</MudText>
    <MudText Typo="Typo.body1" Align="MudBlazor.Align.Center">Add some audio files by clicking the '+' in the top right.</MudText>

}

